<div class="category-management-wrapper">
    <div class="category-management-decoration">
        <div class="decoration-circle decoration-circle-1"></div>
        <div class="decoration-circle decoration-circle-2"></div>
        <div class="decoration-circle decoration-circle-3"></div>
        <div class="decoration-circle decoration-circle-4"></div>
        <div class="decoration-circle decoration-circle-5"></div>
    </div>

    <div class="category-management-container animate-in">
        <div class="category-management-header">
            <div class="logo">
                <h1>House of Chaos</h1>
                <span class="logo-accent">Category Management</span>
            </div>
            <h2 class="page-title">Organize Your Collections</h2>
            <p class="page-subtitle">Review available categories, prepare deletions, or add new ones.</p>
        </div>

        @if (showSuccessBanner) {
            <div class="success-banner" [class.hiding]="isHidingBanner">
                <div class="success-banner-icon">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"/>
                    </svg>
                </div>
                <div class="success-banner-text">
                    <p class="success-banner-title">{{ successBannerTitle }}</p>
                    <p class="success-banner-message">{{ successBannerMessage }}</p>
                </div>
            </div>
        }

        <div class="category-toolbar">
            <div class="toolbar-info">
                <h3>All Categories</h3>
                <span>{{ categories.length }} total</span>
            </div>
            <button class="btn btn-primary" type="button" (click)="onAddCategoryClick()">
                @if (showAddForm) {
                    Close
                } @else {
                    Add Category
                }
            </button>
        </div>

        @if (showAddForm) {
            <div class="add-category-card">
                <form class="add-category-form" [formGroup]="categoryForm" (ngSubmit)="onSubmit()" novalidate>
                    <label for="categoryName">Category Name</label>
                    <div class="add-category-row">
                        <input #categoryNameInput
                               id="categoryName"
                               type="text"
                               formControlName="name"
                               [class.error]="isNameNotValid"
                               placeholder="Enter category name"
                               [disabled]="submitting"
                        />
                        <div class="add-category-actions">
                            <button class="btn btn-primary" type="submit" [disabled]="submitting || categoryForm.invalid">
                                @if (submitting) { Saving... } @else { Save }
                            </button>
                            <button class="btn btn-secondary" type="button" (click)="onCancelAdd()" [disabled]="submitting">
                                Cancel
                            </button>
                        </div>
                    </div>
                    @if (isNameNotValid) {
                        <div class="error-message">
                            <span>Category name is required.</span>
                        </div>
                    }
                    @if (submitError) {
                        <div class="error-message">
                            <span>{{ submitError }}</span>
                        </div>
                    }
                </form>
            </div>
        }

        @if (loading) {
            <div class="loading-state">
                <div class="loading-spinner"></div>
                <p>Loading categories...</p>
            </div>
        } @else if (categories.length === 0) {
            <div class="empty-state">
                <p>No categories available</p>
            </div>
        } @else {
            <div class="categories-grid">
                @for (category of categories; track category.id) {
                    <div class="category-card">
                        <div class="category-icon">
                            <svg viewBox="0 0 24 24" width="30" height="30" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="5" width="18" height="14" rx="2"/>
                                <path d="M3 9h18"/>
                            </svg>
                        </div>
                        <div class="category-info">
                            <span class="category-name">{{ category.name }}</span>
                        </div>
                        <button class="btn btn-outline delete-btn" type="button" (click)="onDeleteCategory(category)">
                            Delete
                        </button>
                    </div>
                }
            </div>
        }
    </div>
</div>

